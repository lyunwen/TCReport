@{
    Layout = "~/Views/Shared/_layout_N.cshtml";
}
@section head{
    <style>
        .form-body {
            font-size: 14px;
            position: absolute;
            width: 300px;
            padding: 20px;
            border-radius: 3px 4px; 
            -moz-border-radius: 6px;
            -webkit-border-radius: 6px;
            border-radius: 6px;
            /*IE 7 AND 8 DO NOT SUPPORT BORDER RADIUS*/
            -moz-box-shadow: 0px 0px 1px #000000;
            -webkit-box-shadow: 0px 0px 1px #000000;
            box-shadow: 0px 0px 1px #000000;
            /*IE 7 AND 8 DO NOT SUPPORT BLUR PROPERTY OF SHADOWS*/
            opacity: 0.88;
            -ms-filter: progid: DXImageTransform.Microsoft.Alpha(Opacity = 88);
            /*-ms-filter must come before filter*/
            filter: alpha(opacity = 88);
            /*INNER ELEMENTS MUST NOT BREAK THIS ELEMENTS BOUNDARIES*/
            /*All filters must be placed together*/
        }

            .form-body .input-cell {
                margin: 20px 0;
            }

            .form-body .input-des {
                display: inline-block;
                width: 65px;
            }

            .form-body .input-center {
                display: inline-block;
            }

                .form-body .input-center input {
                    width: 170px;
                }

            .form-body .errorMsg {
                font-size: 12px;
                color: orangered;
            }

            .form-body .head {
                text-align: center;
                font-size: 16px;
            }

            .form-body .head {
                font-size: 16px;
            }

            .form-body .content-SignIn {
                margin: 10px;
            }

            .form-body .foot {
                float: right;
            }
    </style>
}
<div class="login">
</div>
<script>

    !function() {
        function A(a, b, c) {
            return a.getAttribute(b) || c
        }
        function F(a) {
            return document.getElementsByTagName(a);
        }
        function D() {
            var c = F("script"),
                a = c.length,
                b = c[a - 1];
            return {
                l: a,
                z: A(b, "zIndex", -1),
                o: A(b, "opacity", 0.5),
                c: A(b, "color", "0,0,0"),
                n: A(b, "count", 199)
            }
        }
        function E() {
            x = i.width = window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth;
            B = i.height = window.innerHeight || document.documentElement.clientHeight || document.body.clientHeight;
        }
        function M() {
            J.clearRect(0, 0, x, B);
            var c = [I].concat(v);
            var b, d, a, g, e, f;
            v.forEach(function(h) {
                h.x += h.xa,
                    h.y += h.ya,
                    h.xa *= h.x > x || h.x < 0 ? -1 : 1,
                    h.ya *= h.y > B || h.y < 0 ? -1 : 1,
                    J.fillRect(h.x - 0.5, h.y - 0.5, 1, 1);
                for (d = 0; d < c.length; d++) {
                    b = c[d];
                    if (h !== b && null !== b.x && null !== b.y) {
                        g = h.x - b.x;
                        e = h.y - b.y;
                        f = g * g + e * e;
                        f < b.max && (b === I && f >= b.max / 2 && (h.x -= 0.03 * g, h.y -= 0.03 * e), a = (b.max - f) / b.max, J.beginPath(), J.lineWidth = a / 2, J.strokeStyle = "rgba(" + w.c + "," + (a + 0.2) + ")", J.moveTo(h.x, h.y), J.lineTo(b.x, b.y), J.stroke())
                    }
                }
                c.splice(c.indexOf(h), 1);
            }),
                C(M);
        }
        var i = document.createElement("canvas"),
            w = D(),
            L = "c_n" + w.l, //c_n2
            J = i.getContext("2d"),
            x,
            B,
            C = window.requestAnimationFrame || window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || window.oRequestAnimationFrame || window.msRequestAnimationFrame ||
                function(a) {
                    window.setTimeout(a, 1000 / 45)
                },
            N = Math.random,
            I = {
                x: null,
                y: null,
                max: 20000
            };
        i.id = L;
        i.style.cssText = "position:fixed;top:0;left:0;z-index:" + w.z + ";opacity:" + w.o;
        F("body")[0].appendChild(i);
        E();
        window.onresize = E;
        window.onmousemove = function(a) {
            a = a || window.event,
                I.x = a.clientX,
                I.y = a.clientY
        };
        window.onmouseout = function() {
            I.x = null,
                I.y = null
        };
        for (var v = [], z = 0; w.n > z; z++) {
            var G = N() * x,
                H = N() * B,
                y = 2 * N() - 1,
                K = 2 * N() - 1;
            v.push({
                x: G,
                y: H,
                xa: y,
                ya: K,
                max: 6000
            });
        }
        setTimeout(function() {
            M()
        }, 100)
    } ();
</script>
<div class="form-body border-dashed" id="form-body">
    <div class="head">登入</div>
    <div class="content">
        <div class="content-SignIn">
            <form id="form-SignIn">
                <div class="input-cell">
                    <div class="input-des">
                        <label>用户名</label>
                    </div>
                    <div class="input-center">
                        <input type="text" id="userName" name="UserName" />
                    </div>
                </div>
                <div class="input-cell">
                    <div class="input-des">
                        <label>密码</label>
                    </div>
                    <div class="input-center">
                        <input type="password" id="password" name="Password" />
                    </div>
                </div>
            </form>
        </div>
        <div class="errorMsg"></div>
    </div>
    <div class="foot">
        <input type="button" id="SignIn" value="登入" />
        <a href="/account/signup" style="font-size:12px;">注册界面...</a>
    </div>
</div>
@section foot{
    <script type="text/javascript">
        $(function () {
            $("#SignIn").bind("click", function () { SignIn(); });
            AccessInit(); 
        })

        function SignInValidate() {
            $(".errorMsg").text("");
            var result = true;
            if ($("#userName").val() == "") {
                result = false;
                $(".errorMsg").text($(".errorMsg").text() + " 用户名为空").css("color", "#ff5454").show();
            }
            if ($("#password").val() == "") {
                result = false;
                $(".errorMsg").text($(".errorMsg").text() + " 密码为空").css("color", "#ff5454").show();
            }
            return result;
        }

        function AccessInit() {
            var top = ($(window).height() - $("#form-body").height()) / 3;
            var width = ($(window).width() - $("#form-body").width()) / 2;
            $("#form-body").css("top", parseInt(top) + "px").css("left", parseInt(width) + "px"); 
        }

        function SignIn() {
            if (SignInValidate()) {
                $.ajax({
                    url: "/Account/SignIn",
                    data: $("#form-SignIn").serialize(),
                    beforeSend: function () {
                        $("#SignIn").unbind();
                        $(".errorMsg").text("登入中...").css("color", "#c1bab7").show();
                    },
                    type: "POST",
                    dataType: "json",
                    success: function (e) {
                        if (e.state === "true") {
                            if (e.returnUrl) {
                                window.location.href = returnUrl;
                            }
                            window.location.href = "/home/index"
                        }
                        if (e.state === "false") {
                            $(".errorMsg").text(e.msg).css("color", "#ff5454").show();
                        }
                    },
                    complete: function () {
                        $("#SignIn").bind("click", function () { SignIn(); });
                    }
                });
            }

        }
    </script>
}